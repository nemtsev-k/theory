# Browser

## Базовое понимание Event Loop

## Модель событий

## DOM

**DOM** (Document Object Model) — это специальная древовидная структура, которая позволяет управлять HTML-разметкой из JavaScript-кода. Управление обычно состоит из добавления и удаления элементов, изменения их стилей и содержимого.

DOM описывает HTML-структуру объектами JavScript. Браузер создаёт DOM при загрузке страницы, складывает его в переменную document и сообщает, что DOM создан, с помощью события DOMContentLoaded. С переменной document начинается любая работа с HTML-разметкой в JavaScript. DOM — это не просто точное отражение разметки, а сверхточное, содержащее массу полезных вещей, которые позволяют программисту удобно работать с разметкой.

#### Методы

* **getElementById** — поиск элемента по идентификатору;
* **getElementsByClassName** — поиск элементов по названию класса;
* **getElementsByTagName** — поиск элементов по названию тега;
* **querySelector** — поиск первого элемента, подходящего под CSS-селектор;
* **querySelectorAll** — поиск всех элементов подходящих под CSS-селектор.

Браузер создаёт DOM на основе HTML-кода страницы. Затем на основе DOM и других структур, браузер рисует страницу пользователю. При изменении DOM, браузер анализирует это и обновляет страницу. DOM и страница, которую видит пользователь, связаны. Если изменишь одно, то изменится и второе:

## CSSOM

## Fetch API

## DevTools (debug, source map, lighthouse)

## Performance

## Кроссбраузерность

## setTimeout, setInterval

## Storage API

## Websockets

## Web Worker API

## SharedArray Buffer

## Service Worker APIHTTP

## WebAssembly

## Понимание как развиваются браузеры

## HTTP

**HTTP** (HyperText Transfer Protocol - протокол передачи гипертекста) — это протокол обмена данными между веб-сервером и веб-браузером. Это протокол прикладного уровня модели OSI, который используется для передачи между клиентом и сервером файлов HTML, CSS, JS, API, картинок, аудио, видео, введённых пользователем данных и прочего. Клиент (веб-браузер) отправляет серверу (веб-серверу) запросы и получает от него ответы..

**Структура сообщения следующая:**

* Стартовая строка (Starting line) говорит нам, запрос или ответ содержит сообщение;
* Заголовки (Headers) описывают тело сообщения, параметры передачи и прочие сведения;
* Тело сообщения (Message Body) содержит данные.

#### Стартовая строка

В стартовой строке запроса указывается метод, ссылка и версия протокола, разделённые пробелом.

#### Заголовки

В заголовках содержится информация о домене, о сжатии, шифровании и формате данных, кодировке и прочая важная информация, которая используется для запроса или ответа. Каждый заголовок в HTTP-сообщении представляется отдельной строкой с параметром и значением, разделёнными двоеточием.

#### Тело сообщения

В теле сообщения содержатся данные, которые требуется передать. Тело всегда отделяется от заголовков хотя бы одной пустой строкой. В теле, например, может передаваться HTML-документ или JSON с данными.

HTTP-протокол решает задачу обмена данными. Участники обмена: сервер и клиент. Клиент (например, браузер) формирует запрос и отправляет его серверу. Сервер (программа веб-сервер) получает запрос, анализирует и возвращает ответ. Клиент, получив ответ, обрабатывает его и выполняет какое-то действие. Например, отрисовывает страницу.

Когда вы вводите адрес сайта в адресной строке и нажимаете Enter, происходит примерно следующее (рассматриваем максимально упрощённый сценарий).

Чтобы соединиться с сервером, браузеру необходимо получить его IP-адрес. Мы привыкли пользоваться символьными адресами — их проще запомнить, чем сочетание цифр. Программы, наоборот, предпочитают числа. После ввода в адресной строке htmlacademy.ru, первой задачей браузера станет получение IP-адреса для htmlacademy.ru. Для этого он выполнит запрос к DNS-серверу, который на основании символьного адреса вернёт IP-адрес — 178.79.181.169.

**DNS-сервер** — это сервер, на котором запущено приложение для обработки DNS-запросов. На основании символьного адреса, DNS-сервер возвращает IP-адрес сервера.

Получив IP-адрес, браузер попытается установить соединение с сервером. Для этого он воспользуется протоколом транспортного уровня — TCP. На сервере может быть запущено множество сервисов, но браузер по умолчанию подключится к 80-му порту.

Установив соединение, браузер сформирует HTTP-запрос и передаст его серверу. Здесь и вступает в работу протокол HTTP. Две программы, браузер и сервер, начинают «общаться». Браузер направляет запрос, а сервер — ответ. Запрос — это обычный текст, составленный в соответствии с правилами протокола. Запрос включает в себя служебную информацию и, самое главное, адрес ресурса, который требуется получить.

А почему браузер пытается установить соединение именно на 80-й порт? Как он определяет, что его ждут именно там? По умолчанию веб-серверы ожидают подключений именно на 80-м порту. Это договорённость.

Это, конечно, не означает, что веб-сервер может работать только на 80-м порту. Администратор сервера может изменить правила игры и настроить веб-сервер для приёма соединений от клиентов на другой порт. Например, 3666.

В этом случае порт необходимо указать самостоятельно при вводе адреса. Порт указывается после символа двоеточие (:).

HTTP-запрос состоит из нескольких частей: строка запроса, заголовки (служебная информация) и тело запроса (body). Обязательной является первая часть. Заголовки и тело запроса могут отсутствовать.

**Методы запроса**

* **OPTIONS** — используется для определения возможностей сервера по преобразованию данных.
* **GET** — используется для получения данных от сервера.
* **HEAD** — то же, что и GET, но не содержит тело в сообщении ответа.
* **POST** — используется для отправки данных на сервер.
* **PUT** — используется для добавления новых или изменения существующих данных на сервере.
* **PATCH** — то же, что и PUT, но используется для обновления части данных.
* **DELETE** — используется для удаления данных на сервере.
* **TRACE** — возвращает запрос от клиента таким образом, что в ответе содержится информация о преобразованиях запроса на промежуточных серверах.
* **CONNECT** — переводит текущее соединение в TCP/IP-туннель. Обычно этот метод используется для установления защищённого SSL-соединения.

**Классы кодов состояний:**

* **1xx** — обработка данных на сервере продолжается;
* **2xx** — успешная обработка данных;
* **3xx** — перенаправление запросов;
* **4xx** — ошибка по вине клиента;
* **5xx** — ошибка по вине сервера.

**Самые популярные ответы сервера:**

* **200 OK** - в случае успешной обработки запроса.
* **301 Moved Permanently** - если редирект используется на постоянной основе.
* **307 Temporary Redirect** - если редирект используется временно.
* **400 Bad Request** - если в запросе есть синтаксическая ошибка.
* **403 Forbidden** - если запрос успешный, но сервер его не может выполнить, поскольку пользователь не имеет достаточных прав.
* **404 Not Found** - если запрошенного ресурса не существует.
* **500 Internal** - Server Error если работа программы на сервере выдала ошибку.

HTTPS — это расширение протокола HTTP, а не самостоятельный протокол. Оно добавляет поддержку шифрования трафика, то есть повышает безопасность. Аббревиатура расшифровывается так: HyperText Transfer Protocol Secure — безопасный протокол передачи гипертекста. Соединение, установленное через HTTPS, шифруется. Таким образом, смысл в перехвате трафика теряется.

Вы знаете: по умолчанию веб-сервер ожидает подключение на 80-й порт. Эта договорённость справедлива для протокола HTTP. А для HTTPS-соединений действует другое правило: веб-серверы ожидают безопасные подключения по умолчанию на 443 порту.

Например, чтобы выполнить метод HEAD / для https://htmlacademy.ru, нам необходимо установить соединение с 443 портом вместо 80-го.

**Аутентификация и авторизация**
Чтобы браузер показал окно для ввода логина и пароля при обращении к закрытой странице, сервер должен вернуть код состояния 401 и специальный заголовок.

###Аутентификация и авторизация

**Идентификация** — процесс присваивания какого-либо имени объекту (например, пользователю или программе). Когда человек покупает билет на поезд или самолёт, необходимо представиться. В этот момент он проходит процедуру идентификации.

**Аутентификация** — подтверждение подлинности объекта. При покупке билета или уже на стойке регистрации нужно предъявить паспорт, чтобы доказать, что это тот самый человек, на которого оформлен билет. То есть аутентифицировать — значит подтвердить идентификатор объекта.

**Авторизация** — предоставление прав объекту на что-то. Если человек приходит с билетом на стойку регистрации или к вагону поезда и предъявляет билет и паспорт, ему выдают посадочный талон — возможность долететь / доехать и сопутствующие услуги, согласно классу обслуживания.
